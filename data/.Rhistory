setwd("~/Desktop/Novo EducaSE App/Treinamento/train.nosync/data")
library(descr)
library(dplyr)
load("ranking.RData")
load("censo_ne.RData")
censo_se <- censo_ne %>% filter(state_abbr == "SE")
censo_se$municipality_code[censo_se$year<2007] <- paste(
substr(censo_se$municipality_code,1,2),
substr(censo_se$municipality_code,8,12),
sep = "")
# Filtering only municipal schools
censo_se <- filter(censo_se, type == 3, year > 2004)
load("ranking.RData")
load("censo_ne.RData")
censo_se <- censo_ne %>% filter(state_abbr == "SE")
censo_se <- filter(censo_se, type == 3, year > 2004)
censo_se$municipality_code <- as.numeric(censo_se$municipality_code)
censo_se <- left_join(censo_se, RANKING, by = c("municipality_code"="CO_MUNICIPIO"))
ind_01_library <-  censo_se %>%
dplyr::group_by(municipality_code, NO_MUNICIPIO, year) %>%
dplyr::summarise(library = mean(library=="1", na.rm = TRUE)*100)
ind_02_sports_court <-  censo_se %>%
dplyr::group_by(municipality_code,NO_MUNICIPIO, year) %>%
dplyr::summarise(sports_court = mean(sports_court=="1", na.rm = TRUE)*100)
ind_03_sci_lab <-  censo_se %>%
dplyr::group_by(municipality_code, NO_MUNICIPIO,year) %>%
dplyr::summarise(sci_lab  = mean(sci_lab =="1", na.rm = TRUE)*100)
ind_04_computer_lab <-  censo_se %>%
dplyr::group_by(municipality_code, NO_MUNICIPIO,year) %>%
dplyr::summarise(computer_lab = mean(computer_lab =="1", na.rm = TRUE)*100)
ind_05_handicap_restroom<-  censo_se %>%
dplyr::group_by(municipality_code, NO_MUNICIPIO, year) %>%
dplyr::summarise(handicap_restroom = mean(handicap_restroom =="1", na.rm = TRUE)*100)
ind_06_number_employees<-  censo_se %>%
dplyr::group_by(municipality_code, NO_MUNICIPIO, year) %>%
dplyr::summarise(number_employees = mean(number_employees, na.rm = TRUE))
save(ind_01_library, file = "ind_01_library.RData")
save(ind_02_sports_court, file = "ind_02_sports_court.RData")
save(ind_03_sci_lab, file = "ind_03_sci_lab.RData")
save(ind_04_computer_lab, file = "ind_04_computer_lab.RData")
save(ind_05_handicap_restroom, file = "ind_05_handicap_restroom.RData")
save(ind_06_number_employees, file = "ind_06_number_employees.RData")
View(ind_01_library)
View(dados_municipio)
library(ggpubr)
library(factoextra)
View(dados_municipio)
k_data <- dados_municipio[,c(3,4,8)]
View(k_data)
sergipe_kmeans <- kmeans(scale(k_data[,c(2,3)], 3, nstart = 25)
sergipe_kmeans <- kmeans(scale(k_data[,c(2,3)], 3, nstart = 25)
sergipe_kmeans <- kmeans(k_data[,c(2,3)], 3, nstart = 25)
sergipe_kmeans <- kmeans(k_data[,c(2,3)], 5, nstart = 100)
ggplot(data = kdata, aes(x = pop_2019, y = pib_pc))+
geom_point()
ggplot(data = k_data, aes(x = pop_2019, y = pib_pc))+
geom_point()
View(dados_municipio)
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc))+
geom_point()
k_data <- dados_municipio[,c(3,4,7)]
sergipe_kmeans <- kmeans(k_data[,c(2,3)], 3, nstart = 100)
sergipe_kmeans <- kmeans(k_data[,c(2,3)], 4, nstart = 100)
sergipe_kmeans <- kmeans(k_data[,c(2,3)], 10, nstart = 100)
k_data <- dados_municipio[,c(3,4,7,8)]
sergipe_kmeans <- kmeans(k_data[,c(2,3,4)], 3, nstart = 100)
sergipe_kmeans <- kmeans(k_data[,c(2,3,4)], 5, nstart = 100)
install.packages("factorextra")
sergipe_kmeans <- kmeans(k_data[,c(2,3,4)], 2, nstart = 100)
sergipe_kmeans <- kmeans(k_data[,c(2,3,4)], 6, nstart = 100)
k_data <- dados_municipio[,c(3,4,7)]
k_data <- dados_municipio[,c(3,4,7)]
sergipe_kmeans <- kmeans(k_data[,c(2,3)], 4, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
View(dados_municipio)
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = cluster))+
geom_point()
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
sergipe_kmeans <- kmeans(dados_municipio[,c(4,7)], 6, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
load("/Users/Bruno/Desktop/educa-se/data/dados_municipio.RData")
dados_norm <- scale(dados_municipio)
scale(dados_municipio[,c(4,7)])
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7)]), 6, nstart = 100)
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7)]), 4, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7)]), 5, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7)]), 6, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7)]), 10, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7)]), 4, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7)]), 5, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7,8)]), 4, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7,8)]), 6, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7)]), 4, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
label=mun,
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()+
geom_text(
label=mun,
nudge_x=0.45, nudge_y=0.1,
check_overlap=T
)
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()+
geom_text(label = mun,
nudge_x=0.45, nudge_y=0.1,
check_overlap=T)
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()+
geom_text(label = mun)
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()+
geom_label(label = mun)
View(dados_municipio)
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()+
theme_bw()
sergipe_kmeans <- kmeans(scale(dados_municipio[,c(4,7)]), 5, nstart = 100)
dados_municipio$cluster <- sergipe_kmeans$cluster
ggplot(data = dados_municipio, aes(x = pop_2019, y = inv_pc, color = as.factor(cluster)))+
geom_point()+
theme_bw()
